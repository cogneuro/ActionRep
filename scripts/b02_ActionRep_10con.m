work_dir = '/Users/dojoonyi/cn/CLT/ActionRep/'; prot_dir = 'protocol';	% where raw behavioral data are saved. ons_dir = 'ons';%%%%%%%%%%%%%%%%%%%%%%%%%%  UPLOADING DATA	% Import data from text file.filename = fullfile(work_dir, prot_dir, 'protocol_ActionRep.csv');delimiter = ',';startRow = 2;formatSpec = '%f%f%f%f%f%f%f%f%f%f%f%[^\n\r]';fileID = fopen(filename,'r');dataArray = textscan(fileID, formatSpec, 'Delimiter', delimiter, ...	'TextType', 'string', 'EmptyValue', NaN, 'HeaderLines' ,startRow-1, ...	'ReturnOnError', false, 'EndOfLine', '\r\n');fclose(fileID);TT = [dataArray{1:end-1}];clearvars filename delimiter startRow formatSpec fileID dataArray ans;%%%%%%%%%%%%%%%%%%%%%%%%%% Experimental designTT(:,end+1)=TT(:,8) + (TT(:,2)-1)*490;		% 12_concatenated stim timeTT(:,end+1)=TT(:,9) + TT(:,11) + (TT(:,2)-1)*490; % 13_concatenated RTSN = unique(TT(:,1));names={'self','other','how','why','dum','s_resp','o_resp','h_resp','w_resp','d_resp'}; % dum = no responsedurSTIM = 2;	% 4 secdurRESP = 0;for it=1:length(SN)	xsn = SN(it);	xSS = sprintf('s%02d', SN(it));	if exist(fullfile(work_dir, xSS, ons_dir), 'dir')~=7		mkdir(fullfile(work_dir, xSS, ons_dir));	end	SS = TT(TT(:,1)==xsn,:);	%---------------------------------------------- ONSET INFO.	% Generates setup file			% 1_SN, 2_run, 3_trial, 4_cond, 5_IM, 6_plan, 7_TTL, 8_stim, 9_scale, 10_resp, 11_rt	% 12_concatenated stim time, 13_concatenated RT	onsets = cell(1,4);	difficulty = cell(1,4);	durations = cell(1,5);	for con=1:4		onsets{con}		= SS( SS(:,4)==con & SS(:,10)~=0, 12)/2; 		difficulty{con} = SS( SS(:,4)==con & SS(:,10)~=0, 10)-1;		durations{con}	= durSTIM;		onsets{con+5} = SS( SS(:,4)==con & SS(:,10)~=0, 13)/2; 		durations{con+5} = durRESP;	end	onsets{5} = SS( SS(:,10)==0, 12)/2;	durations{5} = durSTIM;	onsets{10} = SS( SS(:,10)==0, 13)/2;	% in case of no response, it's the scale presentation time.	durations{10} = durRESP;	fid = sprintf('prt_ActionRep_10con_%02d', xsn);	mat_name = fullfile(work_dir, xSS, ons_dir, fid);	save(mat_name, 'names', 'onsets', 'durations', 'difficulty');		fprintf('%s has been saved at %s.\n', fid, fullfile(work_dir, xSS, ons_dir));	clear xTime xCond onsets durations difficulty;end%---------------------------------- EOF.